## 什么是事件代理？

> 事件代理（事件委托）指把多个子元素的监听逻辑绑定到共同的父节点，通过事件冒泡统一处理。

### 快速回答模板
- 先说定义：利用冒泡，把子节点事件委托给父节点统一监听。
- 再讲优势：减少监听器数量，自动兼容动态增删节点。
- 最后补充限制：仅适用于会冒泡的事件，注意 `stopPropagation()`。

### 原理速记
- 浏览器事件默认会从触发元素冒泡到 DOM 树顶层。
- 父元素监听 `event.target` 或 `event.currentTarget` 来区分触发元素。
- 若子元素调用 `event.stopPropagation()` 阻止冒泡，代理会失效。

```js
// 在 ul 上代理 li 点击事件
ul.addEventListener("click", (event) => {
  const item = event.target.closest("li");
  if (!item) return;
  console.log("clicked", item.dataset.id);
});
```

### 实现步骤清单
- 选定稳定存在的父级元素（避免频繁 render 的容器）。
- 绑定事件监听器时，根据业务选择捕获还是冒泡，默认冒泡即可。
- 使用 `event.target.matches()` 或 `closest()` 精确匹配触发源。
- 如需兼容复杂 DOM，可先缓存需要的选择器或数据属性。

常见选择方法：
- `matches(selector)`: 判断当前节点是否匹配指定 CSS 选择器，常用于快速过滤。
- `closest(selector)`: 从当前节点向上寻找最近的匹配元素，适合嵌套结构。
- 两者配合：先 `closest` 拿到目标节点，再操作其数据属性或子元素，避免点到内部图标之类的“误触”。

### 常见应用场景
- **大量子元素**：如长列表、表格行，避免逐个绑定监听器。
- **动态增删节点**：新增元素无需重新绑定事件，删除节点不会遗留监听器。
- **统一行为管理**：在表单、菜单中集中处理不同按钮的点击逻辑。

### 优势
- 减少事件处理函数数量，降低内存占用。
- 更好维护：逻辑集中在一处，绑定/解绑都发生在父节点。
- 适合冒泡事件：如 `click`、`mousedown`、`keypress` 等。

### 局限与注意事项
- 不冒泡或需要捕获的事件（如 `focus`、`blur`）不适用，可改用 `focusin`/`focusout` 或捕获阶段。
- 高频事件（`mousemove`、`mouseout` 等）代理后仍可能频繁触发，需谨慎使用或节流。
- `event.target` 可能是子节点，需要借助 `closest` 或 `matches` 确认目标。
- `event.currentTarget` 永远指向绑定监听的元素，回答区别时别混淆。
- 若业务存在 `stopPropagation()`，需评估是否与代理冲突。

### 面试提示
- 能清楚说明冒泡链路和 `currentTarget`、`target` 区别。
- 理解委托与框架优化：例如 Vue `v-for` 内部已合并事件。
- 提及如何结合事件捕获、`Event Delegation` 在框架外使用的最佳实践。
- 若面试官追问性能，强调监听器数量减少、内存占用下降，并说明仍需避免在根节点做笼统代理导致误触发。