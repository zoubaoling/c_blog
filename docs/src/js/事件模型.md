## 谈谈 JS 中的事件模型

> 核心：事件流的三个阶段 + 不同事件模型（DOM0、DOM2、IE、DOM3）如何绑定/解绑。

### 快速答题顺序
1. 先说事件流：捕获 → 目标 → 冒泡。
2. 再分别介绍 DOM0 / DOM2 / IE 模型的绑定方式与特点。
3. 补充 DOM3 与常见框架的应用，结尾总结差异。

### 事件流（Event Flow）
- **捕获阶段**：事件从 `window` / `document` 自上而下，直到目标元素。
- **目标阶段**：事件到达目标元素。
- **冒泡阶段**：事件自目标元素向上冒泡回顶层（捕获阶段注册的监听在向下时执行，冒泡阶段则在向上时执行）。
- 可以通过 `addEventListener(type, handler, useCapture)` 第三个参数控制监听阶段。

### 事件模型对比
| 模型 | 绑定方式 | 解除方式 | 支持阶段 | 事件回调 `this` 指向 | 同类事件数量 | 典型应用/备注 |
| --- | --- | --- | --- | --- | --- | --- |
| DOM0（原始） | `el.onclick = handler` 或 HTML 内联 `onclick=handler` | `el.onclick = null` 或 `handler=null` | 冒泡(默认-false true-捕获) | 触发元素本身 | 仅 1 个，后者覆盖前者 | 老项目、快速 Demo；兼容最广但功能有限 |
| DOM2（标准） | `el.addEventListener(type, handler, capture?)` | `el.removeEventListener(...)` | 捕获 + 冒泡 + once/passive 等选项 | `currentTarget`（绑定元素） | 可无限个，按注册顺序执行 | 现代浏览器标准；配合事件代理、`passive` 优化滚动 |
| IE（attachEvent） | `el.attachEvent("on"+type, handler)` | `el.detachEvent(...)` | 仅冒泡 | 永远是 `window` | 可多个但顺序不定；需要手动 `bind` | 仅 IE ≤8；`event.srcElement` 替代 `target`，`returnValue=false` 阻止默认行为 |
| DOM3 | 同 DOM2 | 同 DOM2 | 捕获 + 冒泡 | 同 DOM2 | 同 DOM2 | 在 DOM2 基础上扩展：键盘输入、组合、手势等事件；支持 `CustomEvent` |

### 常用 API 与概念点
- `event.target` 指触发事件的具体节点；`event.currentTarget` 指当前执行监听器的节点。
- 阻止行为：`event.preventDefault()`；阻止传播：`event.stopPropagation()`；完全阻止：`stopImmediatePropagation()`。
- 坐标系：`clientX/Y`（相对视口）、`pageX/Y`（相对文档）、`screenX/Y`（相对屏幕）。

### 扩展知识
- Vue/React 等框架底层仍依赖 DOM2 事件模型（Vue `@click` 内部就是 `addEventListener`）。
- DOM1 可视为 DOM0 的规范化版本；DOM3 是在 DOM2 基础上扩展更多事件类型及自定义事件。
- 了解事件委托/代理时需熟悉冒泡阶段：在父级监听，利用 `event.target`/`closest` 区分具体子节点。

### 面试小结
- 讲清楚“事件流顺序 + 模型绑定方式 + API 区别”即可覆盖多数面试问题。
- 强调 DOM2 的优势（多监听器、阶段控制）以及旧浏览器兼容方案（DOM0 / attachEvent）。